---
title: "Hoja de Trabajo 1"
author: "Grupo 5"
date: "2/6/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Hoja de Trabajo 1
library(dplyr)

setwd("C:\Users\diego\Documents\Universidad\7mo Semestre\Mineria\HDT1-Mineria-de-Datos")
movies <- read.csv("tmdb-movies.csv",header = TRUE)

#Inciso 1
summary(movies)
head(movies)

#Inciso 2
glimpse(movies)

#Inciso 3
#Variables cuantitativas.
library(e1071)
popularity = movies$popularity
kurtosis(popularity)

popularity = movies$popularity
kurtosis(popularity)

budget = movies$budget
kurtosis(budget)

revenue = movies$revenue
kurtosis(revenue)

runtime = movies$runtime
kurtosis(runtime)

vote_count = movies$vote_count
kurtosis(vote_count)

vote_average = movies$vote_average
kurtosis(vote_average)
hist(vote_average)

revenue_adj = movies$revenue_adj
kurtosis(revenue_adj)

budget_adj = movies$budget_adj
kurtosis(budget_adj)

#4.1
budget<-movies[with(movies,order(-movies$budget)),1:6]
head(budget,10)

#4.2
budget<-movies[with(movies,order(-movies$revenue)),1:6]
head(budget,10)

#4.3
budget<-movies[with(movies,order(-movies$vote_count)),1:6]
head(budget$original_title,1)

#4.4
budget<-movies[with(movies,order(movies$vote_average)),1:6]
head(budget$original_title,1)

#4.5
movies$cuenta <- 1
movies 
years <- aggregate (movies$cuenta, by = list(movies$release_year), FUN = sum)
vec <- c (years)

colors = c("black","red","blue","grey","orange","pink","purple")
barplot(vec$x, names.arg = vec$Group.1, xlab = "aÃ±o", ylab ="Cantidad de Licas",main = "Promedio de perdidas",col=colors)

#4.6
popularity<-movies[with(movies,order(-movies$popularity)),]
head(popularity$genres,20)

library(tidyr)
category<-popularity %>%separate(genres,c("categoria1","categoria2","categoria3","categoria4"),sep="\\|")
head(category$categoria1,20)
